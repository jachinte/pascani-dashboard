/*!
 * jquery.stacky
 * Copyright (c) 2015 Miguel Jiménez - migueljimenezachinte<a>gmail<d>com | http://migueljimenez.co
 * Licensed under the MIT license.
 * https://github.com/jachinte/jquery.stacky
 * @projectDescription Stacky is a jQuery plugin that gives you the ability to open panels horizontally, as you need them.
 * @author Miguel Jiménez
 * @version v0.3.6
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";var b="Stacky";a[b]=function(b,c){var d={fadeInSpeed:"fast",scrollToSpeed:600,panelDefaults:{after:void 0,content:"",floating:!1,id:"","class":"",onBeforeOpen:function(){},onBeforeClose:function(){}}},e={active:"active",close:"close",collapse:"collapse",expand:"expand",expanded:"expanded",floating:"floating",panel:"panel",panels:"panels",highlight:"highlight"},f=this,g=a(b);f.settings={},f.panels=[],f.init=function(){f.settings=a.extend(!0,{},d,c),g.addClass(e.panels);var b=a("."+e.panel);b.each(function(c){var d=a(this);d.css("z-index",c+1+""),j(d,f.settings.onBeforeClose),c===b.length-1&&d.addClass(e.active),f.panels.push(d)})};var h=function(b){var c=a("<div></div>").addClass("shadow-left"),d=a("<div></div>").addClass("shadow-right"),f=b.id||n(8),g=a("<section></section>").addClass(e.panel).addClass(b["class"]).attr("id",f).append(b.content).append(c).append(d);if(b.floating===!0){g.addClass(e.floating);var h=0;void 0!==b.after&&(g.attr("data-after-panel",b.after.attr("id")),h=i(b.after)),g.css("left",h+"px")}return g},i=function(a){return a.offset().left+(g.scrollLeft()-g.offset().left)},j=function(a,b){var c=a.hasClass(e.expanded)?e.expand:e.collapse;a.find("."+c).hide(),a.on("click","."+e.close,{self:f,callback:b,panel:a},k),a.on("click","."+e.expand,{self:f,panel:a},l),a.on("click","."+e.collapse,{self:f,panel:a},m)},k=function(b){var c=(b.data.self,b.data.callback),d=b.data.panel,h=d.hasClass(e.active),i=g.find("."+e.panel).index(d);return"function"==typeof c&&c(d)===!1?void b.preventDefault():(a("."+e.panel+"[data-after-panel="+d.attr("id")+"]").removeAttr("data-after-panel").css("left","0px").find("."+e.close).trigger("click"),d.hide(),f.panels.splice(i,1),d.remove(),void(h&&g.find("."+e.panel).last().addClass(e.active)))},l=function(b){var c=(b.data.self,b.data.panel);a(this).hide(),a(this).closest("."+e.panel).find("."+e.collapse).show(),c.addClass(e.expanded),f.goTo(c)},m=function(b){var c=(b.data.self,b.data.panel);a(this).hide(),a(this).closest("."+e.panel).find("."+e.expand).show(),c.removeClass(e.expanded),f.goTo(c)},n=function(a){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),c="";a||(a=Math.floor(Math.random()*b.length));for(var d=0;a>d;d++)c+=b[Math.floor(Math.random()*b.length)];return c};f.push=function(b){var c,d=a.extend(!0,{},f.settings.panelDefaults,b),k=g;for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);var l=h(d),m=f.panels.length+1+"";if("undefined"!=typeof b&&b.floating===!0&&(m="10"+m),l.addClass(e.active),l.css("display","none").css("z-index",""+m),k.find("."+e.panel).removeClass(e.active),void 0===d.after||d.after.hasClass(e.floating)){var n=f.panels[f.panels.length-1];void 0!==n?n.after(l):k.append(l),f.panels.push(l)}else{d.after.after(l);var o=g.find("."+e.panel).index(d.after);f.panels.splice(o+1,0,l)}return j(l,d.onBeforeClose),d.onBeforeOpen&&"function"==typeof d.onBeforeOpen&&d.onBeforeOpen(l),l.fadeIn(f.settings.fadeInSpeed),k.animate({scrollLeft:i(l)},f.settings.scrollToSpeed),l},f.closeActive=function(){var a=g.find("."+e.active);a.find(e.close).trigger("click")},f.highlight=function(a){f.goTo(a,function(){a.addClass(e.highlight),setTimeout(function(){a.removeClass(e.highlight)},600)})},f.goTo=function(a,b){g.animate({scrollLeft:i(a)},f.settings.scrollToSpeed,b)},f.init()},a.fn[b]=function(c){return this.each(function(){if(void 0==a(this).data(b)){var d=new a[b](this,c);a(this).data(b,d)}})}});